<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Stravaランキング</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
  <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-6">
    <h1 class="text-2xl font-bold mb-6 text-center">月間ランキング（2025-01）</h1>
    <table class="w-full table-auto border-collapse">
      <thead>
        <tr class="bg-gray-200">
          <th class="p-3 border">順位</th>
          <th class="p-3 border">画像</th>
          <th class="p-3 border">ユーザー名</th>
          <th class="p-3 border">距離（km）</th>
          <th class="p-3 border">時間（分）</th>
          <th class="p-3 border">回数</th>
        </tr>
      </thead>
      <tbody id="ranking-body" class="text-center">
        <!-- JSでここにランキングデータを差し込み -->
      </tbody>
    </table>
  </div>

  <script>
    // ここをあなたのApps ScriptのURLに置き換えてください
    const API_URL = 'https://script.google.com/macros/s/AKfycbxtrZn2wzv9SxlEeov-keDieT_m-4AOEIHivIOjzDkhcPNInj5QqxQ9EaA2-okYjBPiHg/exec?month=2025-01';

    async function fetchRanking() {
      try {
        const res = await fetch(API_URL);
        const json = await res.json();

        const tbody = document.getElementById('ranking-body');
        tbody.innerHTML = '';

        if (json.error) {
          tbody.innerHTML = `<tr><td colspan="6" class="text-red-500">${json.error}</td></tr>`;
          return;
        }

        json.ranking.forEach(item => {
          const tr = document.createElement('tr');
          tr.classList.add('hover:bg-gray-100');

          tr.innerHTML = `
            <td class="border p-2">${item.rank}</td>
            <td class="border p-2">
              <img src="${item.profile_image}" alt="${item.user_name}" class="w-12 h-12 rounded-full mx-auto object-cover" />
            </td>
            <td class="border p-2 font-medium">${item.user_name}</td>
            <td class="border p-2">${item.distance_km}</td>
            <td class="border p-2">${item.time_min}</td>
            <td class="border p-2">${item.count}</td>
          `;
          tbody.appendChild(tr);
        });
      } catch (error) {
        document.getElementById('ranking-body').innerHTML = `<tr><td colspan="6" class="text-red-500">データの取得に失敗しました。</td></tr>`;
        console.error(error);
      }
    }

    fetchRanking();
  </script>
</body>
</html>
